<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Save batch correction plots — save_batch_plots • notame</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Save batch correction plots — save_batch_plots"><meta name="description" content="Saves plots of each feature showing the effect of batch correction.
Plots show QC samples and regular samples inside each batch, plus the
batch mean for biological samples and QC samples as a horizontal line.
The dashed line represents QC mean, the filled line represents biological
sample mean.
NOTE: if you change the shape variable, be sure to set a shape scale as well,
the default scale only has 2 values, so it can only accomodate 2 shapes."><meta property="og:description" content="Saves plots of each feature showing the effect of batch correction.
Plots show QC samples and regular samples inside each batch, plus the
batch mean for biological samples and QC samples as a horizontal line.
The dashed line represents QC mean, the filled line represents biological
sample mean.
NOTE: if you change the shape variable, be sure to set a shape scale as well,
the default scale only has 2 values, so it can only accomodate 2 shapes."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">notame</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">General introduction</a></li>
    <li><a class="dropdown-item" href="../articles/project_example.html">Project example</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hanhineva-lab/notame/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Save batch correction plots</h1>
      <small class="dont-index">Source: <a href="https://github.com/hanhineva-lab/notame/blob/main/R/batch_correction.R" class="external-link"><code>R/batch_correction.R</code></a></small>
      <div class="d-none name"><code>save_batch_plots.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Saves plots of each feature showing the effect of batch correction.
Plots show QC samples and regular samples inside each batch, plus the
batch mean for biological samples and QC samples as a horizontal line.
The dashed line represents QC mean, the filled line represents biological
sample mean.
NOTE: if you change the shape variable, be sure to set a shape scale as well,
the default scale only has 2 values, so it can only accomodate 2 shapes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">save_batch_plots</span><span class="op">(</span></span>
<span>  <span class="va">orig</span>,</span>
<span>  <span class="va">corrected</span>,</span>
<span>  <span class="va">file</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">14</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  batch <span class="op">=</span> <span class="st">"Batch"</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"Batch"</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"QC"</span>,</span>
<span>  color_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"notame.color_scale_dis"</span><span class="op">)</span>,</span>
<span>  shape_scale <span class="op">=</span> <span class="fu">scale_shape_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">21</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  assay.type1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  assay.type2 <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-orig-corrected">orig, corrected<a class="anchor" aria-label="anchor" href="#arg-orig-corrected"></a></dt>
<dd><p><code>
<a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></code>
or <code><a href="MetaboSet-class.html">MetaboSet</a></code> objects before and after batch effect correction</p></dd>


<dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>path to the PDF file where the plots will be saved</p></dd>


<dt id="arg-width-height">width, height<a class="anchor" aria-label="anchor" href="#arg-width-height"></a></dt>
<dd><p>width and height of the plots in inches</p></dd>


<dt id="arg-batch-color-shape">batch, color, shape<a class="anchor" aria-label="anchor" href="#arg-batch-color-shape"></a></dt>
<dd><p>column names of pheno data for batch labels,
and column used for coloring and shaping points (by default batch and QC)</p></dd>


<dt id="arg-color-scale-shape-scale">color_scale, shape_scale<a class="anchor" aria-label="anchor" href="#arg-color-scale-shape-scale"></a></dt>
<dd><p>scales for color and scale as returned by
ggplot functions.</p></dd>


<dt id="arg-assay-type-">assay.type1<a class="anchor" aria-label="anchor" href="#arg-assay-type-"></a></dt>
<dd><p>character, assay of orig to be used in case of
multiple assays.</p></dd>


<dt id="arg-assay-type-">assay.type2<a class="anchor" aria-label="anchor" href="#arg-assay-type-"></a></dt>
<dd><p>character, assay of corrected to be used in case of
multiple assays. If corrected is not supplied, this argument selects
another assay from orig.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>None, the function is invoked for its plot-saving side effect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">example_set</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Batch correction</span></span></span>
<span class="r-in"><span><span class="va">replicates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">example_set</span><span class="op">$</span><span class="va">QC</span> <span class="op">==</span> <span class="st">"QC"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">batch_corrected</span> <span class="op">&lt;-</span> <span class="fu"><a href="ruvs_qc.html">ruvs_qc</a></span><span class="op">(</span><span class="va">example_set</span>, replicates <span class="op">=</span> <span class="va">replicates</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plots of each feature</span></span></span>
<span class="r-in"><span><span class="fu">save_batch_plots</span><span class="op">(</span></span></span>
<span class="r-in"><span>  orig <span class="op">=</span> <span class="va">example_set</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, corrected <span class="op">=</span> <span class="va">batch_corrected</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  file <span class="op">=</span> <span class="st">"batch_plots.pdf"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agg_record_1847801227 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     2 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anton Klåvus, Jussi Paananen, Oskari Timonen, Atte Lihtamo, Vilhelm Suksi, Retu Haikonen, Leo Lahti, Kati Hanhineva.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

