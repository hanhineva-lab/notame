<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Welch's ANOVA and classic ANOVA — perform_oneway_anova • notame</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Welch's ANOVA and classic ANOVA — perform_oneway_anova"><meta name="description" content="Performs ANOVA with Welch's correction as default, to deal with
heterogeneity of variances.
Can also perform classic ANOVA with assumption of equal variances.
Uses base R function oneway.test."><meta property="og:description" content="Performs ANOVA with Welch's correction as default, to deal with
heterogeneity of variances.
Can also perform classic ANOVA with assumption of equal variances.
Uses base R function oneway.test."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">notame</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">General introduction</a></li>
    <li><a class="dropdown-item" href="../articles/project_example.html">Project example</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hanhineva-lab/notame/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Welch's ANOVA and classic ANOVA</h1>
      <small class="dont-index">Source: <a href="https://github.com/hanhineva-lab/notame/blob/main/R/stats.R" class="external-link"><code>R/stats.R</code></a></small>
      <div class="d-none name"><code>perform_oneway_anova.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs ANOVA with Welch's correction as default, to deal with
heterogeneity of variances.
Can also perform classic ANOVA with assumption of equal variances.
Uses base R function <code>oneway.test</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">perform_oneway_anova</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">formula_char</span>,</span>
<span>  all_features <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  assay.type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a <code>
<a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></code>
or <code><a href="MetaboSet-class.html">MetaboSet</a></code> object</p></dd>


<dt id="arg-formula-char">formula_char<a class="anchor" aria-label="anchor" href="#arg-formula-char"></a></dt>
<dd><p>character, the formula to be used in the linear model
(see Details).</p></dd>


<dt id="arg-all-features">all_features<a class="anchor" aria-label="anchor" href="#arg-all-features"></a></dt>
<dd><p>should all features be included in FDR correction?</p></dd>


<dt id="arg-assay-type">assay.type<a class="anchor" aria-label="anchor" href="#arg-assay-type"></a></dt>
<dd><p>character, assay to be used in case of multiple assays</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other parameters to <code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with the results.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The model is fit on combined_data(object). Thus, column names
in pheno data can be specified. To make the formulas flexible, the word
"Feature" must be used to signal the role of the features in the formula.
"Feature" will be replaced by the actual Feature IDs during model fitting.
For example, if testing for equality of means in study groups, use
"Feature ~ Group".</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">example_set</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">perform_oneway_anova</span><span class="op">(</span><span class="va">example_set</span>, formula_char <span class="op">=</span> <span class="st">"Feature ~ Group"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:37:36] Starting ANOVA tests.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:37:36] ANOVA performed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                          Feature_ID    ANOVA_P ANOVA_P_FDR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_259_9623a4_4322 HILIC_neg_259_9623a4_4322 0.56047703   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_108_1065a2_6121 HILIC_neg_108_1065a2_6121 0.80653686   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_158_23a1_4128     HILIC_neg_158_23a1_4128 0.37720565   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_251_0056a0_6161 HILIC_neg_251_0056a0_6161 0.50859597   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_401_52a4_211       HILIC_neg_401_52a4_211 0.40260526   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_400_7045a5_3842 HILIC_neg_400_7045a5_3842 0.47734274   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_304_014a7_1311   HILIC_neg_304_014a7_1311 0.22660630   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_276_6328a2_7734 HILIC_neg_276_6328a2_7734 0.77589629   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_118_9111a4_1865 HILIC_neg_118_9111a4_1865 0.85382843   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_446_9413a2_315   HILIC_neg_446_9413a2_315 0.98992933   0.9899293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_127_5856a4_3758 HILIC_neg_127_5856a4_3758 0.46906067   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_303_2144a1_2372 HILIC_neg_303_2144a1_2372 0.95926120   0.9899293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_366_6203a6_1825 HILIC_neg_366_6203a6_1825 0.24494443   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_258_7252a7_5445 HILIC_neg_258_7252a7_5445 0.21500463   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_301_2643a4_0372 HILIC_neg_301_2643a4_0372 0.55390563   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_224_4031a4_7409 HILIC_neg_224_4031a4_7409 0.71835254   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_424_8488a6_7736 HILIC_neg_424_8488a6_7736 0.73132222   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_131_2034a6_1385 HILIC_neg_131_2034a6_1385 0.52885032   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_236_4114a5_6302 HILIC_neg_236_4114a5_6302 0.25330952   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_411_0148a0_7484 HILIC_neg_411_0148a0_7484 0.18614554   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_288_6263a6_572   HILIC_pos_288_6263a6_572 0.79547124   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_331_1173a7_7822 HILIC_pos_331_1173a7_7822 0.78890868   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_139_4044a6_0388 HILIC_pos_139_4044a6_0388 0.41635473   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_132_7373a6_4146 HILIC_pos_132_7373a6_4146 0.25243102   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_298_6144a3_839   HILIC_pos_298_6144a3_839 0.75840143   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_410_9203a2_7329 HILIC_pos_410_9203a2_7329 0.45191666   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_145_8514a2_811   HILIC_pos_145_8514a2_811 0.84277528   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_306_0061a4_4049 HILIC_pos_306_0061a4_4049 0.51758261   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_425_8858a4_4494 HILIC_pos_425_8858a4_4494 0.32151897   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_436_332a6_1165   HILIC_pos_436_332a6_1165 0.80322099   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_255_0094a7_9288 HILIC_pos_255_0094a7_9288 0.87969382   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_417_1474a2_8239 HILIC_pos_417_1474a2_8239 0.35656392   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_297_8334a0_6647 HILIC_pos_297_8334a0_6647 0.61252944   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_449_2162a0_7574 HILIC_pos_449_2162a0_7574 0.57683501   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_197_7438a7_72     HILIC_pos_197_7438a7_72 0.17573087   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_141_601a7_387     HILIC_pos_141_601a7_387 0.46096274   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_448_1172a6_8567 HILIC_pos_448_1172a6_8567 0.67844879   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_346_6405a3_2719 HILIC_pos_346_6405a3_2719 0.70006195   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_334_3285a1_7395 HILIC_pos_334_3285a1_7395 0.49183404   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_pos_215_5364a2_6707 HILIC_pos_215_5364a2_6707 0.97483378   0.9899293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_458_0877a1_5798       RP_neg_458_0877a1_5798 0.91248271   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_365_8511a5_6086       RP_neg_365_8511a5_6086 0.97808896   0.9899293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_369_5116a6_4389       RP_neg_369_5116a6_4389 0.06843725   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_222_4828a6_0392       RP_neg_222_4828a6_0392 0.13475979   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_114_84a3_0917           RP_neg_114_84a3_0917 0.25208100   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_317_554a3_063           RP_neg_317_554a3_063 0.09240486   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_419_897a3_9617         RP_neg_419_897a3_9617 0.29117081   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_493_3039a6_7816       RP_neg_493_3039a6_7816 0.77127300   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_359_0517a7_3652       RP_neg_359_0517a7_3652 0.57345675   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_435_8009a6_2215       RP_neg_435_8009a6_2215 0.72592571   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_358_2061a5_2818       RP_neg_358_2061a5_2818 0.43811560   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_397_2502a3_7998       RP_neg_397_2502a3_7998 0.79753241   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_165_9294a3_4261       RP_neg_165_9294a3_4261 0.20314383   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_413_1764a3_6741       RP_neg_413_1764a3_6741 0.46248112   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_115_4062a7_7329       RP_neg_115_4062a7_7329 0.19265311   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_300_1295a1_6959       RP_neg_300_1295a1_6959 0.58018018   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_177_6084a5_2913       RP_neg_177_6084a5_2913 0.49639405   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_134_1196a2_9606       RP_neg_134_1196a2_9606 0.68314177   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_139_4456a4_1251       RP_neg_139_4456a4_1251 0.16274136   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_neg_385_6867a4_136         RP_neg_385_6867a4_136 0.91944642   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_490_9235a4_0176       RP_pos_490_9235a4_0176 0.84418941   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_383_4976a2_6503       RP_pos_383_4976a2_6503 0.06588322   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_344_9911a1_9656       RP_pos_344_9911a1_9656 0.78835499   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_117_7095a4_0945       RP_pos_117_7095a4_0945 0.95507768   0.9899293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_294_9596a6_7569       RP_pos_294_9596a6_7569 0.90406183   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_460_4815a0_8843       RP_pos_460_4815a0_8843 0.10367813   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_272_3545a3_5592       RP_pos_272_3545a3_5592 0.57813577   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_409_2445a2_4149       RP_pos_409_2445a2_4149 0.10409987   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_245_9925a3_6251       RP_pos_245_9925a3_6251 0.13216120   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_369_1069a1_6271       RP_pos_369_1069a1_6271 0.89301018   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_174_0715a4_3465       RP_pos_174_0715a4_3465 0.56968718   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_324_6195a4_7743       RP_pos_324_6195a4_7743 0.42672674   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_149_432a4_1341         RP_pos_149_432a4_1341 0.23999866   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_461_5891a7_1505       RP_pos_461_5891a7_1505 0.11034460   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_458_263a4_3477         RP_pos_458_263a4_3477 0.50316471   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_226_7218a3_1371       RP_pos_226_7218a3_1371 0.73029862   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_280_3779a4_0424       RP_pos_280_3779a4_0424 0.45773178   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_447_3232a2_2393       RP_pos_447_3232a2_2393 0.87744479   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_453_282a5_128           RP_pos_453_282a5_128 0.65526139   0.9807428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_153_9636a7_9986       RP_pos_153_9636a7_9986 0.87652410   0.9807428</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anton Klåvus, Jussi Paananen, Oskari Timonen, Atte Lihtamo, Vilhelm Suksi, Retu Haikonen, Leo Lahti, Kati Hanhineva.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

