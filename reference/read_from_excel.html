<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Read formatted Excel files — read_from_excel • notame</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read formatted Excel files — read_from_excel"><meta name="description" content="Reads data from an Excel file of the following format:
Left side of the sheet contains information about the features, size
features x feature info columns
Top part contains sample information, size sample info variables x
samples
The middle contains the actual abundances, size features x samples
This function separates the three parts from the file, and returns them in a
list."><meta property="og:description" content="Reads data from an Excel file of the following format:
Left side of the sheet contains information about the features, size
features x feature info columns
Top part contains sample information, size sample info variables x
samples
The middle contains the actual abundances, size features x samples
This function separates the three parts from the file, and returns them in a
list."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">notame</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">General introduction</a></li>
    <li><a class="dropdown-item" href="../articles/project_example.html">Project example</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hanhineva-lab/notame/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Read formatted Excel files</h1>
      <small class="dont-index">Source: <a href="https://github.com/hanhineva-lab/notame/blob/main/R/class_constructor.R" class="external-link"><code>R/class_constructor.R</code></a></small>
      <div class="d-none name"><code>read_from_excel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Reads data from an Excel file of the following format:</p><ul><li><p>Left side of the sheet contains information about the features, size
features x feature info columns</p></li>
<li><p>Top part contains sample information, size sample info variables x
samples</p></li>
<li><p>The middle contains the actual abundances, size features x samples</p></li>
</ul><p>This function separates the three parts from the file, and returns them in a
list.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_from_excel</span><span class="op">(</span></span>
<span>  <span class="va">file</span>,</span>
<span>  sheet <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  id_column <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  corner_row <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  corner_column <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id_prefix <span class="op">=</span> <span class="st">"ID_"</span>,</span>
<span>  split_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mz_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">2000</span><span class="op">)</span>,</span>
<span>  rt_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  skip_checks <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>path to the Excel file</p></dd>


<dt id="arg-sheet">sheet<a class="anchor" aria-label="anchor" href="#arg-sheet"></a></dt>
<dd><p>the sheet number or name</p></dd>


<dt id="arg-id-column">id_column<a class="anchor" aria-label="anchor" href="#arg-id-column"></a></dt>
<dd><p>character, column name for unique identification of samples</p></dd>


<dt id="arg-corner-row">corner_row<a class="anchor" aria-label="anchor" href="#arg-corner-row"></a></dt>
<dd><p>integer, the bottom row of sample information,
usually contains data file names and feature info column names.
If set to NULL, will be detected automatically.</p></dd>


<dt id="arg-corner-column">corner_column<a class="anchor" aria-label="anchor" href="#arg-corner-column"></a></dt>
<dd><p>integer or character, the corresponding column number
or the column name (letter) in Excel.
If set to NULL, will be detected automatically.</p></dd>


<dt id="arg-id-prefix">id_prefix<a class="anchor" aria-label="anchor" href="#arg-id-prefix"></a></dt>
<dd><p>character, prefix for autogenerated sample IDs, see Details</p></dd>


<dt id="arg-split-by">split_by<a class="anchor" aria-label="anchor" href="#arg-split-by"></a></dt>
<dd><p>character vector, in the case where all the modes are in the
same Excel file, the column names of feature data used to separate the modes
(usually Mode and Column)</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>in the case where the Excel file only contains one mode, the
name of the mode, such as "Hilic_neg"</p></dd>


<dt id="arg-mz-limits">mz_limits<a class="anchor" aria-label="anchor" href="#arg-mz-limits"></a></dt>
<dd><p>numeric vector of two, all m/z values should be in between
these</p></dd>


<dt id="arg-rt-limits">rt_limits<a class="anchor" aria-label="anchor" href="#arg-rt-limits"></a></dt>
<dd><p>numeric vector of two, all retention time values should be
in between these</p></dd>


<dt id="arg-skip-checks">skip_checks<a class="anchor" aria-label="anchor" href="#arg-skip-checks"></a></dt>
<dd><p>logical: skip checking and fixing of data integrity. Not
recommended, but sometimes useful when you just want to read the data in as
is and fix errors later. The data integrity checks are important for
functioning of notame.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of three data frames:</p><ul><li><p>exprs: the actual abundances, size features x samples</p></li>
<li><p>pheno_data: sample information, size sample info variables x samples</p></li>
<li><p>feature_data: information about the features, size features x
feature info columns</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If skip_checks = FALSE, <code>read_from_excel</code> attempts to modify the
data as per <code><a href="fix_object.html">fix_object</a></code> and checks the data. If skip_checks
= TRUE, parameters for <code>fix_object</code> are ignored.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">read_from_excel</span><span class="op">(</span></span></span>
<span class="r-in"><span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_set.xlsx"</span>, </span></span>
<span class="r-in"><span>  package <span class="op">=</span> <span class="st">"notame"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="fl">1</span>, corner_row <span class="op">=</span> <span class="fl">11</span>, corner_column <span class="op">=</span> <span class="st">"H"</span>,</span></span>
<span class="r-in"><span>  split_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Column"</span>, <span class="st">"Ion_mode"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Corner detected correctly at row 11, column H</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Extracting sample information from rows 1 to 11 and columns I to BF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Replacing spaces in sample information column names with underscores (_)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Naming the last column of sample information "Datafile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Extracting feature information from rows 12 to 91 and columns A to H</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Extracting feature abundances from rows 12 to 91 and columns I to BF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Pheno data was cleaned</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Feature data was cleaned</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checking sample information</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Checking 'Injection_order' column in feature data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Checking 'Sample_ID' column in pheno data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Checking 'QC' column in feature data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Checking that feature abundances only contain numeric values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checking feature information</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Checking that feature IDs are unique and not storedas numbers</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Checking that m/z and retention time values are reasonable.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Identified m/z column Average_Mz and retention time column Average_Rt_min</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Identified m/z column Average_Mz and retention time column Average_Rt_min</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Checking that feature data includes a 'Split' column</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Checking that feature data includes a 'Flag' column</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">modes</span> <span class="op">&lt;-</span> <span class="fu"><a href="construct_metabosets.html">construct_metabosets</a></span><span class="op">(</span>exprs <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">exprs</span>, </span></span>
<span class="r-in"><span>  pheno_data <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">pheno_data</span>, feature_data <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">feature_data</span>,</span></span>
<span class="r-in"><span>  group_col <span class="op">=</span> <span class="st">"Group"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checking feature information</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Checking that feature IDs are unique and not storedas numbers</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Checking that feature data includes a 'Split' column</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Checking that feature data includes a 'Flag' column</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Checking that feature abundances only contain numeric values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:38:12] Setting row and column names of exprs based on feature and pheno data</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anton Klåvus, Jussi Paananen, Oskari Timonen, Atte Lihtamo, Vilhelm Suksi, Retu Haikonen, Leo Lahti, Kati Hanhineva.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

