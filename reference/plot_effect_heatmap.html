<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Heatmap of effects between variables, such as correlations — plot_effect_heatmap • notame</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Heatmap of effects between variables, such as correlations — plot_effect_heatmap"><meta name="description" content="Draws a heatmap of e.g. correlations between variables
(see perform_correlation_tests).
It is possible to draw only the lower triangular of the heatmap, order rows
and columns with hierarchical clustering, and add circles for p-values."><meta property="og:description" content="Draws a heatmap of e.g. correlations between variables
(see perform_correlation_tests).
It is possible to draw only the lower triangular of the heatmap, order rows
and columns with hierarchical clustering, and add circles for p-values."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">notame</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">General introduction</a></li>
    <li><a class="dropdown-item" href="../articles/project_example.html">Project example</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hanhineva-lab/notame/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Heatmap of effects between variables, such as correlations</h1>
      <small class="dont-index">Source: <a href="https://github.com/hanhineva-lab/notame/blob/main/R/effect_heatmap.R" class="external-link"><code>R/effect_heatmap.R</code></a></small>
      <div class="d-none name"><code>plot_effect_heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Draws a heatmap of e.g. correlations between variables
(see perform_correlation_tests).
It is possible to draw only the lower triangular of the heatmap, order rows
and columns with hierarchical clustering, and add circles for p-values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_effect_heatmap</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">effect</span>,</span>
<span>  p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p_limit <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  point_size_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  log2_effect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  discretize_effect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  breaks <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  clustering <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dist_method <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  clust_method <span class="op">=</span> <span class="st">"ward.D2"</span>,</span>
<span>  lower_tri <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  reverse_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_coord_fixed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  symmetric_aspect_ratio <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fill_scale <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data frame with x and y variables and the effect</p></dd>


<dt id="arg-x-y">x, y<a class="anchor" aria-label="anchor" href="#arg-x-y"></a></dt>
<dd><p>the column names of data with the x and y variables</p></dd>


<dt id="arg-effect">effect<a class="anchor" aria-label="anchor" href="#arg-effect"></a></dt>
<dd><p>the column name of the effect, e.g. correlation</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>optional, the column name with p-values. If provided, points that
scale by p-value are drawn on top of the heatmap tiles</p></dd>


<dt id="arg-p-limit">p_limit<a class="anchor" aria-label="anchor" href="#arg-p-limit"></a></dt>
<dd><p>numeric, only p-values below the limit are plotted as points</p></dd>


<dt id="arg-point-size-range">point_size_range<a class="anchor" aria-label="anchor" href="#arg-point-size-range"></a></dt>
<dd><p>a numeric vector of length 2. The upper and lower
limits for the point sizes. This needs to be adjusted to make the point size
look good when compared to the tiles</p></dd>


<dt id="arg-log-effect">log2_effect<a class="anchor" aria-label="anchor" href="#arg-log-effect"></a></dt>
<dd><p>logical, whether the effect should be plotted on a
logarithmic scale (in case of fold change etc.)</p></dd>


<dt id="arg-discretize-effect">discretize_effect<a class="anchor" aria-label="anchor" href="#arg-discretize-effect"></a></dt>
<dd><p>logical, whether the effect range should be divided
into discrete levels instead of using a continuous scale. Can sometimes make
patterns more visible, but the hard limits can blur the big picture as well.</p></dd>


<dt id="arg-breaks">breaks<a class="anchor" aria-label="anchor" href="#arg-breaks"></a></dt>
<dd><p>if <code>discretize_effect = TRUE</code>, either the number of
breaks or the points where to cut for the levels, see <code><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></code></p></dd>


<dt id="arg-clustering">clustering<a class="anchor" aria-label="anchor" href="#arg-clustering"></a></dt>
<dd><p>logical, whether the order of rows and columns should be
ordered by hierarchical clustering?</p></dd>


<dt id="arg-dist-method">dist_method<a class="anchor" aria-label="anchor" href="#arg-dist-method"></a></dt>
<dd><p>distance method used in clustering, see <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code></p></dd>


<dt id="arg-clust-method">clust_method<a class="anchor" aria-label="anchor" href="#arg-clust-method"></a></dt>
<dd><p>clustering method used in clustering, see
<code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code></p></dd>


<dt id="arg-lower-tri">lower_tri<a class="anchor" aria-label="anchor" href="#arg-lower-tri"></a></dt>
<dd><p>logical, should only the lower triangular be plotted?</p></dd>


<dt id="arg-reverse-y">reverse_y<a class="anchor" aria-label="anchor" href="#arg-reverse-y"></a></dt>
<dd><p>logical, if <code>clustering = FALSE, lower_tri = FALSE</code>,
should the order of the y-axis
be reversed so that the diagonal is from top left to bottom right?</p></dd>


<dt id="arg-use-coord-fixed">use_coord_fixed<a class="anchor" aria-label="anchor" href="#arg-use-coord-fixed"></a></dt>
<dd><p>logical, should the heatmap tiles be squares?
If yes, this uses <code><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></code></p></dd>


<dt id="arg-symmetric-aspect-ratio">symmetric_aspect_ratio<a class="anchor" aria-label="anchor" href="#arg-symmetric-aspect-ratio"></a></dt>
<dd><p>logical, should the plot panel be a square?
If yes, uses ggplot2::theme(aspect.ratio = 1).</p></dd>


<dt id="arg-title-subtitle">title, subtitle<a class="anchor" aria-label="anchor" href="#arg-title-subtitle"></a></dt>
<dd><p>the title and subtitle of the plot</p></dd>


<dt id="arg-fill-scale">fill_scale<a class="anchor" aria-label="anchor" href="#arg-fill-scale"></a></dt>
<dd><p>fill scale for the heatmap as returned by a ggplot
function. Set to NA to choose the appropriate scale based on the class of
the effect variable.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>All missing effects between variables are replaced by 0 before
clustering, since <code>hclust</code> can't deal with missing values.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></code> for discretizing the effect, <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>
for distance calculation for clustering,
<code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code> for hierarchical clustering.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">example_set</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Compute correlations between variables</span></span></span>
<span class="r-in"><span><span class="va">correlations</span> <span class="op">&lt;-</span> <span class="fu"><a href="perform_correlation_tests.html">perform_correlation_tests</a></span><span class="op">(</span><span class="va">example_set</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">example_set</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  duplicates <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:37:41] Starting correlation tests.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:37:41] Performing correlation tests for single object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:37:43] Correlation tests performed.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Minimal example</span></span></span>
<span class="r-in"><span><span class="fu">plot_effect_heatmap</span><span class="op">(</span><span class="va">correlations</span>, </span></span>
<span class="r-in"><span>x <span class="op">=</span> <span class="st">"X"</span>, y <span class="op">=</span> <span class="st">"Y"</span>, effect <span class="op">=</span> <span class="st">"Correlation_coefficient"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_effect_heatmap-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Lower triangular with discrete effect and p-value dots</span></span></span>
<span class="r-in"><span><span class="fu">plot_effect_heatmap</span><span class="op">(</span><span class="va">correlations</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"X"</span>, y <span class="op">=</span> <span class="st">"Y"</span>, effect <span class="op">=</span> <span class="st">"Correlation_coefficient"</span>,</span></span>
<span class="r-in"><span>  p <span class="op">=</span> <span class="st">"Correlation_P"</span>, point_size_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  discretize_effect <span class="op">=</span> <span class="cn">TRUE</span>, breaks <span class="op">=</span> <span class="fl">7</span>, lower_tri <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_effect_heatmap-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anton Klåvus, Jussi Paananen, Oskari Timonen, Atte Lihtamo, Vilhelm Suksi, Retu Haikonen, Leo Lahti, Kati Hanhineva.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

