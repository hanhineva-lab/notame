<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Flag features with low detection rate — flag_detection • notame</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Flag features with low detection rate — flag_detection"><meta name="description" content="Flags features with too high amount of missing values. There are two
detection rate limits, both defined as the minimum proportion of samples
that need to have a value (not NA) for the feature to be kept.
'qc_limit is the detection rate limit for QC samples,
'group_limit is the detection rate limit for the actual study groups.
If the group limit is passed for AT LEAST ONE GROUP, then the feature is
kept. Features with low detection rate in QCs are flagged as
&quot;Low_qc_detection&quot;, while low detection rate in the study groups is flagged
as &quot;Low_group_detection&quot;. The detection rates for all the groups are
recorded in feature data."><meta property="og:description" content="Flags features with too high amount of missing values. There are two
detection rate limits, both defined as the minimum proportion of samples
that need to have a value (not NA) for the feature to be kept.
'qc_limit is the detection rate limit for QC samples,
'group_limit is the detection rate limit for the actual study groups.
If the group limit is passed for AT LEAST ONE GROUP, then the feature is
kept. Features with low detection rate in QCs are flagged as
&quot;Low_qc_detection&quot;, while low detection rate in the study groups is flagged
as &quot;Low_group_detection&quot;. The detection rates for all the groups are
recorded in feature data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">notame</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">General introduction</a></li>
    <li><a class="dropdown-item" href="../articles/project_example.html">Project example</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hanhineva-lab/notame/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Flag features with low detection rate</h1>
      <small class="dont-index">Source: <a href="https://github.com/hanhineva-lab/notame/blob/main/R/quality_metrics.R" class="external-link"><code>R/quality_metrics.R</code></a></small>
      <div class="d-none name"><code>flag_detection.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Flags features with too high amount of missing values. There are two
detection rate limits, both defined as the minimum proportion of samples
that need to have a value (not NA) for the feature to be kept.
'<code>qc_limit</code> is the detection rate limit for QC samples,
'<code>group_limit</code> is the detection rate limit for the actual study groups.
If the group limit is passed for AT LEAST ONE GROUP, then the feature is
kept. Features with low detection rate in QCs are flagged as
"Low_qc_detection", while low detection rate in the study groups is flagged
as "Low_group_detection". The detection rates for all the groups are
recorded in feature data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">flag_detection</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  qc_limit <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  group_limit <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  assay.type <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a <code>
<a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></code>
or <code><a href="MetaboSet-class.html">MetaboSet</a></code> object</p></dd>


<dt id="arg-qc-limit">qc_limit<a class="anchor" aria-label="anchor" href="#arg-qc-limit"></a></dt>
<dd><p>the detection rate limit for QC samples</p></dd>


<dt id="arg-group-limit">group_limit<a class="anchor" aria-label="anchor" href="#arg-group-limit"></a></dt>
<dd><p>the detection rate limit for study groups</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>the columns name in sample information to use as the grouping
variable</p></dd>


<dt id="arg-assay-type">assay.type<a class="anchor" aria-label="anchor" href="#arg-assay-type"></a></dt>
<dd><p>character, assay to be used in case of multiple assays</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A SummarizedExperiment or MetaboSet object with the features flagged.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">example_set</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ex_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="mark_nas.html">mark_nas</a></span><span class="op">(</span><span class="va">example_set</span>, value <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ex_set</span> <span class="op">&lt;-</span> <span class="fu">flag_detection</span><span class="op">(</span><span class="va">ex_set</span>, group <span class="op">=</span> <span class="st">"Group"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-06-23 22:36:34] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1% of features flagged for low detection rate</span>
<span class="r-in"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">ex_set</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 80 rows and 11 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                       Feature_ID       Split Alignment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                      &lt;character&gt; &lt;character&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_259_9623a4_4322 HILIC_neg_259_9623a4..   HILIC_neg         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_108_1065a2_6121 HILIC_neg_108_1065a2..   HILIC_neg         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_158_23a1_4128   HILIC_neg_158_23a1_4..   HILIC_neg         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_251_0056a0_6161 HILIC_neg_251_0056a0..   HILIC_neg         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_401_52a4_211    HILIC_neg_401_52a4_211   HILIC_neg         5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...                                          ...         ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_226_7218a3_1371    RP_pos_226_7218a3_1371      RP_pos        16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_280_3779a4_0424    RP_pos_280_3779a4_0424      RP_pos        17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_447_3232a2_2393    RP_pos_447_3232a2_2393      RP_pos        18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_453_282a5_128        RP_pos_453_282a5_128      RP_pos        19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_153_9636a7_9986    RP_pos_153_9636a7_9986      RP_pos        20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           Average_Mz Average_Rt_min      Column    Ion_mode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            &lt;numeric&gt;      &lt;numeric&gt; &lt;character&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_259_9623a4_4322    259.962       4.432241       HILIC         neg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_108_1065a2_6121    108.107       2.612073       HILIC         neg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_158_23a1_4128      158.230       1.412822       HILIC         neg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_251_0056a0_6161    251.006       0.616145       HILIC         neg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_401_52a4_211       401.520       4.210970       HILIC         neg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...                              ...            ...         ...         ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_226_7218a3_1371       226.722        3.13714          RP         pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_280_3779a4_0424       280.378        4.04238          RP         pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_447_3232a2_2393       447.323        2.23926          RP         pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_453_282a5_128         453.282        5.12797          RP         pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_153_9636a7_9986       153.964        7.99864          RP         pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  Flag Detection_rate_Group_A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           &lt;character&gt;              &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_259_9623a4_4322          NA                   0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_108_1065a2_6121          NA                   0.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_158_23a1_4128            NA                   0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_251_0056a0_6161          NA                   0.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_401_52a4_211             NA                   0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...                               ...                    ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_226_7218a3_1371             NA                   0.85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_280_3779a4_0424             NA                   0.85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_447_3232a2_2393             NA                   0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_453_282a5_128               NA                   0.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_153_9636a7_9986             NA                   0.80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           Detection_rate_Group_B Detection_rate_QC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                        &lt;numeric&gt;         &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_259_9623a4_4322                   0.90               1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_108_1065a2_6121                   0.95               0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_158_23a1_4128                     0.90               0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_251_0056a0_6161                   0.95               1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HILIC_neg_401_52a4_211                      0.95               1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...                                          ...               ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_226_7218a3_1371                       0.9               0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_280_3779a4_0424                       0.9               1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_447_3232a2_2393                       0.9               0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_453_282a5_128                         1.0               0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RP_pos_153_9636a7_9986                       0.9               0.8</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anton Klåvus, Jussi Paananen, Oskari Timonen, Atte Lihtamo, Vilhelm Suksi, Retu Haikonen, Leo Lahti, Kati Hanhineva.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

