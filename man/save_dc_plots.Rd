% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/drift_correction.R
\name{save_dc_plots}
\alias{save_dc_plots}
\title{Save drift correction plots}
\usage{
save_dc_plots(
  orig,
  dc,
  predicted,
  file,
  log_transform = TRUE,
  width = 16,
  height = 8,
  color = "QC",
  shape = color,
  color_scale = getOption("notame.color_scale_dis"),
  shape_scale = scale_shape_manual(values = c(15, 16))
)
}
\arguments{
\item{orig}{a MetaboSet object, before drift correction}

\item{dc}{a MetaboSet object, after drift correction as returned by 
correct_drift}

\item{predicted}{a matrix of predicted values, as returned by dc_cubic_spline}

\item{file}{path to the PDF file where the plots should be saved}

\item{log_transform}{logical, was the drift correction done on log-
transformed data?}

\item{width, height}{width and height of the plots in inches}

\item{color}{character, name of the column used for coloring the points}

\item{shape}{character, name of the column used for shape}

\item{color_scale}{the color scale as returned by a ggplot function}

\item{shape_scale}{the shape scale as returned by a ggplot function}
}
\value{
None, the function is invoked for its plot-saving side effect.
}
\description{
Plots the data before and after drift correction, with the regression line 
drawn with the original data. If the drift correction was done on 
log-transformed data, then plots of both the original and log-transformed 
data before and after correction are drawn.
The plot shows 2 standard deviation spread for both QC samples and regular 
samples.
}
\details{
By default, the column used for color is also used for shape.
}
\examples{
\dontshow{.old_wd <- setwd(tempdir())}
dc <- dc_cubic_spline(example_set)
corrected <- dc$object
inspected <- inspect_dc(
  orig = example_set, dc = corrected,
  check_quality = TRUE
)
save_dc_plots(
  orig = example_set[1], dc = corrected[1], 
  predicted = dc$predicted[1, ],
  file = "drift_plots.pdf"
)
\dontshow{setwd(.old_wd)}
}
\seealso{
\code{\link{correct_drift}}
}
