<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>General introduction • notame</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="General introduction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">notame</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">General introduction</a></li>
    <li><a class="dropdown-item" href="../articles/project_example.html">Project example</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hanhineva-lab/notame/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>General introduction</h1>
                        <h4 data-toc-skip class="author">Anton Klåvus,
Vilhelm Suksi</h4>
            
            <h4 data-toc-skip class="date">2025-06-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hanhineva-lab/notame/blob/main/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>From the perspective of metabolites as the continuation of the
central dogma of biology, metabolomics provides the closest link to many
phenotypes of interest. This makes metabolomics research promising in
teasing apart the complexities of living systems, attracting many new
practitioners.</p>
<p>The <em>notame</em> R package was developed in parallel with an
associated protocol article as a general guideline for data analysis in
untargeted metabolomics studies <span class="citation">(Klåvus et al.
2020)</span>. The main outcome is identifying interesting features for
laborious downstream steps relating to biological context, such as
metabolite identification and pathway analysis, which fall outside the
purview of <em>notame</em>. Bioconductor packages with complementary
functionality in Bioconductor include pmp, phenomis and qmtools;
<em>notame</em> brings partially overlapping and new functionality to
the table. There are also Bioconductor packages for preprocessing,
metabolite identification and pathway analysis. Together,
<em>notame</em>, Bioconductor’s dependency management and other
Bioconductor functionality allow for quality, reproducible metabolomics
research.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install <em>notame</em>, install BiocManager first, if it is not
installed. Afterwards use the install function from BiocManager.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"notame"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hanhineva-lab/notame" class="external-link">notame</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-it-works">How it works<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h2>
<p>SummarizedExperiment is the primary data structure of this package,
but MetaboSet is still supported for old users’ preference. One can use
a single peak table throughout the analysis as with MetaboSet and also
use multiple peak tables with SummarizedExperiment, using the
<code>assay.type</code> and <code>name</code> arguments.</p>
<p>The functionality of <em>notame</em> can be broadly divided into
tabular data preprocessing and feature selection, excluding sample
preprocessing and functionality related to biological context (Figure
1). Tabular data processing involves reducing unwanted variation and
data preparation dependent on downstream methods. The many
visualizations used for inspecting the process also serve as exploratory
data analysis. Feature selection aims to select a subset of interesting
features across study groups before laborious steps relating to
biological context. Please see the documentation for an overview of
functionality (?notame), the Project Example vignette for usage and the
associated protocol article for more information <span class="citation">(Klåvus et al. 2020)</span>.</p>
<div class="figure">
<img src="Overview.png" alt="Overview of untargeted LC-MS metabolomics data analysis." width="372"><p class="caption">
Overview of untargeted LC-MS metabolomics data analysis.
</p>
</div>
<div class="section level3">
<h3 id="input">Input<a class="anchor" aria-label="anchor" href="#input"></a>
</h3>
<p>Data can be read with <code><a href="../reference/read_from_excel.html">read_from_excel()</a></code>, which includes
checks and preparation of metadata. To accommodate typical output from
peak-picking software such as Agilent’s MassHunter or MS-DIAL, the
output is transformed into a spreadsheet for
<code><a href="../reference/read_from_excel.html">read_from_excel()</a></code>. Alternatively, data in R can be wrangled
and passed to the <code><a href="../reference/construct_metabosets.html">construct_metabosets()</a></code> or
<code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment()</a></code> constructor.</p>
<div class="figure">
<img src="Data_input.png" alt="Structure of spreadsheet for read_from_excel()." width="640"><p class="caption">
Structure of spreadsheet for read_from_excel().
</p>
</div>
<p>There are a few obligatory fields for <code><a href="../reference/read_from_excel.html">read_from_excel()</a></code>,
including “Injection_order” in sample information, “Mass” or “Average
mz” in feature data and “Retention time”, “RetentionTime”, “Average
rt(min)” or “rt” in feature information (not case sensitive). There are
further optional fields, including “Sample_ID” and “QC” in sample data
as well as “Feature_ID” in feature data, which are automatically
generated if unavailable. One or more fields in feature data can be used
to split the data into parts, usually LC column x ionization mode,
supplied as arguments to the <code>split_by</code> parameter. If the
file only contains one mode, specify the name of the mode,
e.g. “HILIC_pos” to the <code>name</code> parameter.</p>
</div>
<div class="section level3">
<h3 id="tabular-data-preprocessing">Tabular data preprocessing<a class="anchor" aria-label="anchor" href="#tabular-data-preprocessing"></a>
</h3>
<p>The main functions return modified objects and are largely based on
pooled QC samples <span class="citation">(Broadhurst et al.
2018)</span>. Tabular data preprocessing is generally performed
separately for each mode. The visualizations used to monitor tabular
data preprocessing are saved to file by default, but can also be
returned as ggplot objects. The <code><a href="../reference/visualizations.html">visualizations()</a></code> wrapper
can be used for saving visualizations at different stages of
processing.</p>
</div>
<div class="section level3">
<h3 id="feature-selection">Feature selection<a class="anchor" aria-label="anchor" href="#feature-selection"></a>
</h3>
<p>Univariate statistics functions return a <code>data.frame</code>, to
be manually filtered before inclusion into the feature data of the
instance. Supervised learning functions return various data
structures.</p>
<p>Comprehensive results visualizations are returned as ggplot objects
and can be saved to file using <code><a href="../reference/save_plot.html">save_plot()</a></code>. Interesting
features can be inspected with feature-wise visualizations which are
saved to file by default but can be returned as a list.</p>
</div>
<div class="section level3">
<h3 id="utilities">Utilities<a class="anchor" aria-label="anchor" href="#utilities"></a>
</h3>
<p>General utilities include <code><a href="../reference/combined_data.html">combined_data()</a></code> for
representing the instance in a <code>data.frame</code> suitable for
plotting and various functions for data wrangling. For keeping track of
the analysis, <em>notame</em> offers a logging system operated using
<code><a href="../reference/init_log.html">init_log()</a></code>, <code><a href="../reference/log_text.html">log_text()</a></code> and
<code><a href="../reference/finish_log.html">finish_log()</a></code>. <em>notame</em> also keeps track of all the
external packages used, offering you references for each. To see and log
a list of references, use <code><a href="../reference/citations.html">citations()</a></code>.</p>
<p>Parallellization is used in many feature-wise calculations and is
provided by the BiocParallel package. BiocParallel defaults to a
parallel backend. For small-scale testing on Windows, it can be quicker
to use serial execution:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></span><span class="op">(</span><span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="authors-acknowledgements">Authors &amp; Acknowledgements<a class="anchor" aria-label="anchor" href="#authors-acknowledgements"></a>
</h2>
<p>The first version of <em>notame</em> was written by Anton Klåvus for
his master’s thesis in Bioinformatics at Aalto university (published
under former name Anton Mattsson), while working for University of
Eastern Finland and Afekta Technologies. The package is inspired by
analysis scripts written by Jussi Paananen and Oskari Timonen. The
algorithm for clustering molecular features originating from the same
compound is based on MATLAB code written by David Broadhurst, Professor
of Data Science &amp; Biostatistics in the School of Science, and
director of the Centre for Integrative Metabolomics &amp; Computational
Biology at the Edith Covan University.</p>
<p>If you find any bugs or other things to fix, please submit an issue
on GitHub! All contributions to the package are always welcome!</p>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<pre><code><span><span class="co">## R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] BiocStyle_2.36.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] digest_0.6.37       desc_1.4.3          R6_2.6.1           </span></span>
<span><span class="co">##  [4] bookdown_0.43       fastmap_1.2.0       xfun_0.52          </span></span>
<span><span class="co">##  [7] cachem_1.1.0        knitr_1.50          htmltools_0.5.8.1  </span></span>
<span><span class="co">## [10] png_0.1-8           rmarkdown_2.29      lifecycle_1.0.4    </span></span>
<span><span class="co">## [13] cli_3.6.5           sass_0.4.10         pkgdown_2.1.3      </span></span>
<span><span class="co">## [16] textshaping_1.0.1   jquerylib_0.1.4     systemfonts_1.2.3  </span></span>
<span><span class="co">## [19] compiler_4.5.1      tools_4.5.1         ragg_1.4.0         </span></span>
<span><span class="co">## [22] evaluate_1.0.4      bslib_0.9.0         yaml_2.3.10        </span></span>
<span><span class="co">## [25] BiocManager_1.30.26 jsonlite_2.0.0      rlang_1.1.6        </span></span>
<span><span class="co">## [28] fs_1.6.6            htmlwidgets_1.6.4</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-qcguidelines" class="csl-entry">
Broadhurst, David, Royston Goodacre, Stacey N Reinke, Julia Kuligowski,
Ian D Wilson, Matthew R Lewis, and Warwick B Dunn. 2018.
<span>“Guidelines and Considerations for the Use of System Suitability
and Quality Control Samples in Mass Spectrometry Assays Applied in
Untargeted Clinical Metabolomic Studies.”</span> <em>Metabolomics</em>
14: 1–17.
</div>
<div id="ref-notame" class="csl-entry">
Klåvus, Anton, Marietta Kokla, Stefania Noerman, Ville M Koistinen,
Marjo Tuomainen, Iman Zarei, Topi Meuronen, et al. 2020.
<span>“<span>‘Notame’</span>: Workflow for Non-Targeted LC–MS Metabolic
Profiling.”</span> <em>Metabolites</em> 10 (4): 135.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anton Klåvus, Jussi Paananen, Oskari Timonen, Atte Lihtamo, Vilhelm Suksi, Retu Haikonen, Leo Lahti, Kati Hanhineva.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
